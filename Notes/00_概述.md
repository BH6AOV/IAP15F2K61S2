# 51单片机学习笔记

## 单片机了解

> 假期开始学习51单片机，备战4月份的蓝桥杯比赛
>
> 今天先对这款 **CT107D** 进行一些基础的了解, 内容参考《CT107D单片机综合实训平台使用说明书》
>
> 更新日期：2020-01-03

[TOC]

### 一、功能说明

CT107D单片机综合实训平台由以下功能模块组成。

#### 1.1 单片机芯片

配置 **40 脚 51 系列单片机插座**（支持 IAP15F2K61S2 转接板、 STC89C52RC 等）.

配置 **40 脚 AVR 单片机插座**（支持 Atmega16、 Atmega8515 等）.

#### 1.2 显示模块

配置 **8 路 LED 输出**.

配置 **8 位 8 段共阳数码管**.

配置 **LCM1602 和 12860 液晶接口**.

#### 1.3 输入/输出模块

配置 **4×4 键盘矩阵**，其中四个按键可通过跳线配置为独立按键.

配置**继电器、蜂鸣器**.

配置**功率放大电路，驱动扬声器**.

#### 1.4 传感模块

配置**红外一体头 1838 及红外发射管**.

配置**一个霍尔传感器**.

配置**光敏电阻**.

配置**数字温度传感器 DS18B20**.

配置**超声波收发探头及相应的驱动电路**.

#### 1.5 电源

USB 和外接 **5V 直流电源双电源供电**。

#### 1.6 通信功能

**板载 USB 转串口功能**，可以完成单片机与 PC 的串行通信和程序下载.

**单总线扩展**，可以外接其它单总线接口器件.

**I2C 总线**，可以做 I2C 总线实验.

#### 1.7 存储/IO 扩展

配置 **8255 扩展芯片**.

配置 **EEPROM 芯片 AT24C02**.

#### 1.8 程序下载

板载 USB 下载功能，不需要另外配备编程器.

板载 USB 转串口功能，可以对支持串行下载功能的芯片进行程序下载。

#### 1.9 A/D、 D/A 模块

配置 **PCF8591A/D、 D/A 芯片，内含 8 位 4 通道 A/D 转换、单通道 D/A 转换**。

#### 1.10 信号发生模块

配置**一个 555 方波发生器**，可以产生实验所需的 200Hz 到 20Khz 的方波信号。

#### 1.11 其它

配置**信号放大模块**，可以对输入的低电压模拟信号进行放大.

配置**138 译码器**， 可以做译码实验.

外设可以用存储器映射方式访问，也可以直接控制 I/O 口访问.

单片机全部端口可外接，方便系统扩展.

### 二、实训平台布局

各个功能模块在实验板上的布局如下：

<div style="align: center">
<img src="https://github.com/ZHJ0125/IAP15F2K61S2/blob/master/Notes/image/%E5%9B%BE1.1%E5%AE%9E%E9%AA%8C%E5%B9%B3%E5%8F%B0%E5%B8%83%E5%B1%80.png"/>
</div>

<center> 图1.1 实验平台布局 </center>

### 三、跳线说明

#### 3.1 超声/红外功能选择跳线（J2）

 1-3 短接， 2-4 短接：选择超声波测距功能
 5-3 短接， 6-4 短接：选择红外发射/接收功能

#### 3.2) USB 功能选择（J4）

 1-2 短接：选择 UART 功能， USB 接口用作串行通信，使用 IAP15 系列转接板
时应配置此模式进行程序下载。
 2-3 短接：选择 PROG 功能，通过 USB 接口对 AT89S52 编程

#### 3.3) 按键功能选择（J5）

 1-2 短接：选择 4 x 4 键盘功能
 2-3 短接：选择 4 个独立按键功能

#### 3.4) 外设访问方式选择（J13）

 1-2 短接：选择存储器映射方式
 2-3 短接：选择 I/O 口直接控制方式

#### 3.5) 复位选择跳线（J15）

 1-2 短接：选择 51 系列单片机
 2-3 短接：选择 AVR 系列单片机

#### 四、电位器功能说明

1) 电位器 Rb1: 用于调节液晶模块的显示清晰度电位器
2) 电位器 Rb2: 调节电压值，可以用于 A/D 输入电位器
3) 电位器 Rb3: 用于调节方波发生器的频率 电位器
4) 电位器 Rb4: 用于调节信号放大模块的放大倍数

### 五、接口说明

#### 5.1 单片机扩展接口

单片机扩展接口如图 1.2 所示，其中 00 ~ 07 对应单片机的P0 口， P10~P17 对应单片 机
的P1 口， P20~P27 对应单片机的P2 口， P30~P37 对应单片机的P3 口， ALE 对应单 片机
的ALE 管脚（ALE 管脚同时接载Atmega16 单片机的AREF 管脚上）

<div style="align: center">
<img src="https://github.com/ZHJ0125/IAP15F2K61S2/blob/master/Notes/image/%E5%9B%BE1.2%20%E5%8D%95%E7%89%87%E6%9C%BA%E6%89%A9%E5%B1%95%E6%8E%A5%E5%8F%A3.png"/>
</div>

<center> 图1.2 单片机扩展接口 </center>

备注： 使用 IAP15 系列转接板时， P36 和 P37 引脚对应为 IAP15F2K61S2 单片机的
P42 和 P44 引脚， 详见 IAP15F2K61S2 单片机转接板技术资料。

#### 5.2 输入/输出接口

输入输出接口如图 1.3 所示，其中： HALL： 接霍尔器件的输出管脚 P24： 51 单片机的
P24 管脚 1WIRE：单线总线接口 MOT：直流电机驱动输出 A、 B、 C、 D：步进电机驱动输
出 SPK：外接扬声器 SIGNAL：方波发生器输出 P34： 51 单片机的 P34 管脚 A/D：模数转
换输入 D/A：数模转换输出。

<div style="align: center">
<img src="https://github.com/ZHJ0125/IAP15F2K61S2/blob/master/Notes/image/%E5%9B%BE1.3%20%E5%8D%95%E7%89%87%E6%9C%BA%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%8E%A5%E5%8F%A3.png"/>
</div>

<center> 图1.3 输入输出接口 </center>

#### 5.3 信号放大接口

信号放大接口如图 1.4 所示， 其中 GND 和VCC 分别接地和电源， IN+和IN-分别接被放
大信号的正负输入极。

<div style="align: center">
<img src="https://github.com/ZHJ0125/IAP15F2K61S2/blob/master/Notes/image/%E5%9B%BE1.4%20%E4%BF%A1%E5%8F%B7%E6%94%BE%E5%A4%A7%E6%8E%A5%E5%8F%A3.png"/>
</div>

<center> 图1.4 信号放大接口 </center>

### 六、端口资源分配

#### 6.1 51单片机 P0 端口

| 端口号 | 功能1 |
|:---|:---|
| P0.0 | 数据总线 |
| P0.1 | 数据总线 |
| P0.2 | 数据总线 |
| P0.3 | 数据总线 |
| P0.4 | 数据总线 |
| P0.5 | 数据总线 |
| P0.6 | 数据总线 |
| P0.7 | 数据总线 |

#### 6.2 51单片机 P1 端口

| 端口号 | 功能1 | 功能2 |
|:---|:---|:---|
| P1.0 | 超声发射 | 红外发射 |
| P1.1 | 超声接收 | 红外接收 |
| P1.2 | 字符液晶使能信号 | 图形液晶使能信号 |
| P1.3 | DS1302 的RST 脚 |
| P1.4 | 1wire 总线 |
| P1.5 | 下载线： MOSI |
| P1.6 | 下载线： MISO  |
| P1.7 | 下载线： SCK | DS1302 的SCK 脚 |

#### 6.3 51单片机 P2 端口

|端口号 | 功能1 | 功能2 | 功能3|
|:---|:---|:---|:---|
| P2.0 | 字符LCD 信号： RS | 图形LCD 信号： RS | I2C 总线的SCL |
| P2.1 | 字符LCD 信号： RW | 图形LCD 信号： RW | I2C 总线的SDA |
| P2.2 | 8255 的A0 脚 | 图形LCD 信号：串并选择 |
| P2.3 | DS1302 的IO 脚 | 8255 的A1 脚 |
| P2.4 | 霍尔器件输入 |
| P2.5 | 138 译码器A |
| P2.6 | 138 译码器B |
| P2.7 | 138 译码器C |

#### 6.4 51单片机 P3 端口

| 端口号 | 功能1 | 功能2 | 功能3|
|:---|:---|:---|:---|
| P3.0 | 独立按键1，按下时置低 | 串行接收RXD | 键盘矩阵 行1 |
| P3.1 | 独立按键2，按下时置低 | 串行发送TXD | 键盘矩阵 行2 |
| P3.2 | 独立按键3，按下时置低 | | 键盘矩阵 行3 |
| P3.3 | 独立按键4，按下时置低 | | 键盘矩阵 行4 |
| P3.4 | | 频率测量（跳线） | 键盘矩阵 列4 |
| P3.5 | | | 键盘矩阵 列3 |
| P3.6 | 写信号 | | 键盘矩阵 列2 |
| P3.7 | 读信号 | | 键盘矩阵 列1 |

#### 6.5 138译码器输出

| 端口号 | 功能 |
|:---|:---|
| Y0 | 未用 |
| Y1 | 未用 |
| Y2 | 未用 |
| Y3 | 8255 的CE 脚Y4 LED 锁存信号 |
| Y5 | UNL2003 输出锁存信号 |
| Y6 | 数码管位选锁存信号 |
| Y7 | 数码管段选锁存信号 |

#### 6.6 锁存器 U9 输出（接 UNL2003）

| 端口号 | 功能 |
|:---|:---|
| 端口0 | 步进电机驱动A |
| 端口1 | 步进电机驱动B |
| 端口2 | 步进电机驱动C |
| 端口3 | 步进电机驱动D |
| 端口4 | 继电器输出 |
| 端口5 | 直流电机驱动 |
| 端口6 | 蜂鸣器 |
| 端口7 | 音频放大输出 |

#### 6.7 A/D 输入通道

| 通道号 | 功能 |
|:---|:---|
| 通道0 | 外接插针 |
| 通道1 | 光敏检测 |
| 通道2 | 放大器输出 |
| 通道3 | 电位器 |

接下来是单片机软件配置的内容，包括安装驱动和烧录软件的说明，详细说明可以看一下 PDF ，这里就不写出来了。
