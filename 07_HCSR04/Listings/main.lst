C51 COMPILER V9.57.0.0   MAIN                                                              12/03/2019 09:37:14 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\MDK\install\Core\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define uint unsigned int
   5          #define FSOC 11059200L
   6          #define CYCLE (12000000.0/FSOC)
   7          sbit HC138_A = P2^5;
   8          sbit HC138_B = P2^6;
   9          sbit HC138_C = P2^7;
  10          sbit TRIG=P1^0;         // Send
  11          sbit ECHO=P1^1;         // Recive
  12          uchar code tab[] = {0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0x40,0x79,0x24,0x30,0x19,0x12,0x12,0
             -x78,0x00,0x12,0x9C,0xC6};
  13          uchar code select[] = {0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
  14          uint distence = 0;
  15          //#define somenop{_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();}
  16          
  17          void Delay10us()                //@11.0592MHz
  18          {
  19   1              unsigned char i;
  20   1              _nop_();
  21   1              i = 25;
  22   1              while (--i);
  23   1      }
  24          
  25          void Delay2ms()         //@11.0592MHz
  26          {
  27   1              unsigned char i, j;
  28   1              _nop_();
  29   1              _nop_();
  30   1              i = 22;
  31   1              j = 128;
  32   1              do
  33   1              {
  34   2                      while (--j);
  35   2              } while (--i);
  36   1      }
  37          
  38          void System_Init()
  39          {
  40   1              HC138_A = 1;
  41   1              HC138_B = 0;
  42   1              HC138_C = 1;
  43   1              WR = 0;
  44   1              P0 = 0x00;
  45   1              HC138_A = 0;
  46   1              HC138_B = 0;
  47   1              HC138_C = 1;
  48   1              WR = 0;
  49   1              P0 = 0xFF;
  50   1      }
  51          
  52          void LED_Display(uchar selection, uchar segment)
  53          {
C51 COMPILER V9.57.0.0   MAIN                                                              12/03/2019 09:37:14 PAGE 2   

  54   1              HC138_A = 0;
  55   1              HC138_B = 1;
  56   1              HC138_C = 1;
  57   1              WR = 0;
  58   1              P0 = 0x00;
  59   1              HC138_A = 1;
  60   1              HC138_B = 1;
  61   1              HC138_C = 1;
  62   1              WR = 0;
  63   1              P0 = tab[segment];
  64   1              HC138_A = 0;
  65   1              HC138_B = 1;
  66   1              HC138_C = 1;
  67   1              WR = 0;
  68   1              P0 = select[selection];
  69   1              Delay2ms();
  70   1              HC138_A = 1;
  71   1              HC138_B = 1;
  72   1              HC138_C = 1;
  73   1              WR = 0;
  74   1              P0 = 0xFF;
  75   1      }
  76          
  77          void Send_Info()
  78          {
  79   1              uint i;
  80   1              for(i=0; i<8; i++)
  81   1              {
  82   2                      TRIG = 1;
  83   2                      Delay10us();
  84   2                      TRIG = 0;
  85   2                      Delay10us();
  86   2              }
  87   1      }
  88          
  89          void Timer1_Init(void)
  90          {
  91   1              AUXR &= 0xBF;   // 定时器T1 12分频
  92   1              TMOD &= 0x0F;   // 定时器T1 方式1
  93   1              TL1 = 0x00;
  94   1              TH1 = 0x00;
  95   1              TF1 = 0;
  96   1      }
  97          
  98          
  99          void main()
 100          {
 101   1              uint temp,i;
 102   1              System_Init();
 103   1              Timer1_Init();
 104   1              while(1)
 105   1              {
 106   2                      Send_Info();
 107   2                      TR1 = 1;
 108   2                      while((ECHO)&&(!TF1));
 109   2                      TR1 = 0;
 110   2                      if(TF1)
 111   2                      {
 112   3                              TF1 = 0;
 113   3                              distence = 999;
 114   3                      }
 115   2                      else
C51 COMPILER V9.57.0.0   MAIN                                                              12/03/2019 09:37:14 PAGE 3   

 116   2                      {
 117   3                              temp = ((TH1 << 8) | TL1);
 118   3                              distence = temp * CYCLE * 0.017;
 119   3                              TL1 = 0x00;     
 120   3                              TH1 = 0x00;
 121   3                      }
 122   2                      distence = (uint)(distence*10);
 123   2                      for(i=0; i<50g; i++)
*** ERROR C141 IN LINE 123 OF main.c: syntax error near 'g'
*** ERROR C202 IN LINE 123 OF main.c: 'g': undefined identifier
*** ERROR C141 IN LINE 123 OF main.c: syntax error near ')'
 124   2                      {
 125   3                              LED_Display(4, distence/1000);
 126   3                              LED_Display(5, distence/100%10);
 127   3                              LED_Display(6, distence%100/10+10);
 128   3                              LED_Display(7, distence%10);
 129   3                      }
 130   2              }
 131   1      }

C51 COMPILATION COMPLETE.  0 WARNING(S),  3 ERROR(S)
